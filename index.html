<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Tools</title>
    
    <!-- 外部样式表 -->
    <link rel="stylesheet" href="style.css">
    
<!-- 可以替换为自己的CDN地址 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.9.359/pdf.min.js"></script>
<script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- 背景装饰 -->
    <div class="bg-decoration">
        <div class="bg-shape"></div>
        <div class="bg-shape"></div>
        <div class="bg-shape"></div>
    </div>

    <!-- 主容器 -->
    <div class="ios-container">
        <!-- 顶部导航 -->
        <div class="ios-nav">
            <div class="ios-title">PDF Tools</div>
        </div>

        <!-- 主内容区域 -->
        <div class="ios-main">
            <!-- 左侧面板 -->
            <div class="ios-left-panel">
                <div class="panel-header">
                    <span class="panel-title">控制面板</span>
                    <span class="panel-badge">导入 & 操作</span>
                </div>
                <div class="scroll-area">
                    <!-- 上传区域 -->
                    <div class="ios-upload-area" id="dropArea">
                        <div class="ios-upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <div class="ios-upload-text">导入PDF文件</div>
                        <div class="ios-upload-hint">点击选择或拖放文件到此处</div>
                        <label class="ios-upload-btn">
                            选择文件
                            <input type="file" id="fileInput" accept=".pdf" multiple>
                        </label>
                    </div>

                    <!-- 批量操作 -->
                    <div class="ios-actions">
                        <div class="ios-actions-title">批量操作</div>
                        <div class="ios-actions-grid">
                            <button class="ios-action-btn" onclick="selectDeselectAll()" id="selectAllBtn" data-tooltip="全选/取消全选">
                                <i class="fas fa-check-square"></i> 全选
                            </button>
                            <button class="ios-action-btn danger" onclick="deleteSelected()" id="deleteSelectedBtn" disabled data-tooltip="删除选中项">
                                <i class="fas fa-trash"></i> 删除
                            </button>
                            <button class="ios-action-btn rotate" onclick="rotateSelected(90)" id="rotateRightBtn" disabled data-tooltip="右旋90°">
                                <i class="fas fa-redo"></i> 右旋
                            </button>
                            <button class="ios-action-btn rotate" onclick="rotateSelected(270)" id="rotateLeftBtn" disabled data-tooltip="左旋90°">
                                <i class="fas fa-undo"></i> 左旋
                            </button>
                            <button class="ios-action-btn merge" onclick="mergePages()" id="mergeBtn" disabled data-tooltip="合并所有页面">
                                <i class="fas fa-link"></i> 合并
                            </button>
                            <button class="ios-action-btn" onclick="downloadSelectedPages()" id="downloadSelectedBtn" disabled data-tooltip="下载选中页面">
                                <i class="fas fa-file-download"></i> 下载选中
                            </button>
                        </div>
                    </div>

                    <!-- 替换操作区 -->
                    <div class="ios-actions">
                        <div class="ios-actions-title">替换操作</div>
                        <div class="replace-section">
                            <div class="replace-section-title">批量替换：选择页面 → 选择新文件</div>
                            <div class="replace-section-actions">
                                <button class="ios-btn replace-btn" onclick="initReplaceMode()" id="replaceModeBtn" data-tooltip="进入替换模式">
                                    <i class="fas fa-exchange-alt"></i> 启用替换
                                </button>
                                <label class="ios-btn replace-btn" style="display: none;" id="replaceFileLabel" data-tooltip="选择替换文件">
                                    <i class="fas fa-file-upload"></i> 选择文件
                                    <input type="file" id="replaceFileInput" accept=".pdf" style="display: none;">
                                </label>
                            </div>
                            <div id="replaceStatus" class="replace-status">状态: 未激活</div>
                        </div>
                    </div>

                    <!-- 统计信息 -->
                    <div class="ios-actions">
                        <div class="ios-actions-title">统计信息</div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                            <div class="stat-box">
                                <div class="stat-value" id="totalPagesStat">0</div>
                                <div class="stat-label">总页面</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-value" id="selectedPagesStat">0</div>
                                <div class="stat-label">已选中</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 右侧面板 -->
            <div class="ios-right-panel">
                <div class="panel-header">
                    <span class="panel-title">页面列表</span>
                    <span class="panel-badge" id="pagesCount">0 页</span>
                </div>
                <div class="scroll-area">
                    <div class="ios-pages-grid" id="pagesGrid">
                        <div class="ios-empty-state">
                            <div class="ios-empty-icon">
                                <i class="fas fa-file-pdf"></i>
                            </div>
                            <div class="ios-empty-title">暂无PDF文件</div>
                            <div class="ios-empty-text">请从左侧导入PDF文件开始处理<br>支持多个文件同时导入</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 底部状态栏 -->
        <div class="ios-footer">
            <!-- 左侧统计信息 -->
            <div class="ios-footer-stats">
                <div class="ios-footer-stat">
                    <i class="fas fa-layer-group"></i>
                    <span>总页数:</span>
                    <span class="ios-stat-value" id="footerTotal">0</span>
                </div>
                <div class="ios-footer-stat">
                    <i class="fas fa-check-circle"></i>
                    <span>选中:</span>
                    <span class="ios-stat-value" id="footerSelected">0</span>
                </div>
            </div>

            <!-- 中间按钮区域 -->
            <div class="ios-footer-actions">
                <button class="ios-footer-btn clear" onclick="clearAll()" data-tooltip="清空所有页面" id="footerClearBtn" disabled>
                    <i class="fas fa-trash-alt"></i>
                    清空
                </button>
                <button class="ios-footer-btn download" onclick="downloadPDF()" data-tooltip="生成并下载PDF" id="footerDownloadBtn" disabled>
                    <i class="fas fa-download"></i>
                    下载
                </button>
            </div>

            <!-- 右侧状态文字 -->
            <div class="ios-footer-status" id="statusText">就绪</div>
        </div>
    </div>

    <!-- 替换确认模态框 -->
    <div class="ios-modal" id="replaceConfirmModal">
        <div class="ios-modal-content">
            <div class="ios-modal-header">
                <div class="ios-modal-title">确认替换</div>
                <button class="ios-modal-close" onclick="closeReplaceConfirmModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="ios-modal-body">
                <p id="replaceConfirmText">确定要用新文件替换选中的页面吗？</p>
                <div id="replacePreview" style="margin-top: 12px; padding: 12px; background: #F2F2F7; border-radius: 10px; font-size: 13px; border: 1px solid #E5E5EA;">
                    <div style="color: #1C1C1E; margin-bottom: 8px; font-weight: 700;">替换预览:</div>
                    <div id="replacePreviewContent" style="color: #8E8E93;">等待选择文件...</div>
                </div>
            </div>
            <div class="ios-modal-actions">
                <button class="ios-btn ios-btn-secondary" onclick="closeReplaceConfirmModal()">
                    <i class="fas fa-times"></i> 取消
                </button>
                <button class="ios-btn ios-btn-accent" onclick="executeReplace()">
                    <i class="fas fa-check"></i> 确认替换
                </button>
            </div>
        </div>
    </div>

    <!-- 画质选择模态框 -->
    <div class="ios-modal" id="imageQualityModal">
        <div class="ios-modal-content">
            <div class="ios-modal-header">
                <div class="ios-modal-title">选择图片质量</div>
                <button class="ios-modal-close" onclick="closeImageQualityModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="ios-modal-body">
                <p>请选择导出图片的质量（分辨率）：</p>
                <div class="quality-options">
                    <div class="quality-btn" onclick="selectQuality('low')" id="qualityLow">
                        <i class="fas fa-image" style="color: #FF9500;"></i>
                        <span class="quality-label">低质量</span>
                        <span class="quality-value">72 DPI</span>
                    </div>
                    <div class="quality-btn" onclick="selectQuality('medium')" id="qualityMedium">
                        <i class="fas fa-images" style="color: #007AFF;"></i>
                        <span class="quality-label">中等质量</span>
                        <span class="quality-value">150 DPI</span>
                    </div>
                    <div class="quality-btn" onclick="selectQuality('high')" id="qualityHigh">
                        <i class="fas fa-photo-video" style="color: #34C759;"></i>
                        <span class="quality-label">高质量</span>
                        <span class="quality-value">300 DPI</span>
                    </div>
                </div>
                <div style="text-align: center; color: var(--text-secondary); font-size: 12px; margin-top: 10px;">
                    当前页面: <span id="qualityPageName" style="font-weight: 700; color: var(--text-primary);"></span>
                </div>
            </div>
            <div class="ios-modal-actions">
                <button class="ios-btn ios-btn-secondary" onclick="closeImageQualityModal()">
                    <i class="fas fa-times"></i> 取消
                </button>
                <button class="ios-btn ios-btn-accent" onclick="confirmConvertToImage()">
                    <i class="fas fa-image"></i> 导出图片
                </button>
            </div>
        </div>
    </div>

    <!-- 加载遮罩 -->
    <div class="ios-loading" id="loadingOverlay">
        <div class="ios-spinner"></div>
        <div class="ios-loading-text" id="loadingText">正在处理...</div>
    </div>

    <!-- Toast提示 -->
    <div class="ios-toast" id="toast"></div>

    <!-- 外部JavaScript -->
    <script src="script.js"></script>
</body>
</html>